run_id: reduce_pooling_mvp

conditions_csv: assets/conditions/gri30_tiny.csv
report_dir: reports

reduction:
  mode: pooling

qoi:
  species_last: [CO2, CO, H2O, CH4, O2]
  species_max: [OH, HO2]

evaluation:
  rel_tolerance: 0.40
  rel_eps: 1.0e-12
  surrogate_split:
    mode: kfold
    kfolds: 2
  physical_gate:
    enabled: true
    max_conservation_violation: 5.0e-3
    max_negative_steps: 0

surrogate:
  model: linear_ridge
  l2: 1.0e-6
  perturb_gain: 1.0
  blend_reference: 0.0

gate:
  min_pass_rate: 0.75
  max_mean_rel_diff: 0.40
  max_conservation_violation: 0.0

merge:
  hard:
    element_overlap_required: true
  overlap_method: jaccard
  soft:
    penalty:
      phase: 0.80
      charge: 0.80
      radical: 0.40
      role: 0.30
  weights:
    elem: 1.0
    frag: 0.8
    flux: 1.2
    role: 0.5
  species_meta:
    - name: CH4
      composition: {C: 1, H: 4}
      phase: gas
      charge: 0
      radical: false
      role: fuel
    - name: CH
      composition: {C: 1, H: 1}
      phase: gas
      charge: 0
      radical: true
      role: fuel
    - name: CF4
      composition: {C: 1, F: 4}
      phase: gas
      charge: 0
      radical: false
      role: etch
    - name: F
      composition: {F: 1}
      phase: gas
      charge: 0
      radical: true
      role: etch
    - name: N
      composition: {N: 1}
      phase: gas
      charge: 0
      radical: true
      role: carrier
    - name: H
      composition: {H: 1}
      phase: gas
      charge: 0
      radical: true
      role: carrier

synthetic:
  n_reactions: 24

search:
  seed: 7
  merge_search:
    min_pair_score: -0.50
  stages:
    - name: A
      target_ratio: 0.75
      penalty_scale: 1.00
      prune_lambda: 0.001
      prune_keep_ratio: 0.90
      prune_threshold: 0.45
      prune_exact_keep: true
      metric_drift: 1.02
    - name: B
      target_ratio: 0.55
      penalty_scale: 0.70
      prune_lambda: 0.004
      prune_keep_ratio: 0.70
      prune_threshold: 0.40
      prune_exact_keep: true
      metric_drift: 1.08
    - name: C
      target_ratio: 0.35
      penalty_scale: 0.40
      prune_lambda: 0.010
      prune_keep_ratio: 0.50
      prune_threshold: 0.35
      prune_exact_keep: true
      metric_drift: 1.15

pooling:
  graph: species
  artifact_dir: artifacts/pooling
  fallback_to_rule_based_on_error: true
  graph_cfg: {}
  feature_cfg: {}
  constraint_cfg:
    hard:
      element_overlap_required: true
      same_phase_required: false
    soft:
      penalty:
        phase: 0.8
        charge: 0.8
        radical: 0.4
        role: 0.3
  constraints:
    hard_weight: 10.0
    soft_weight: 1.0
  model:
    backend: pyg
    seed: 7
    hidden_dim: 16
  train:
    temperature: 0.7
  tuning:
    seed: 7
    graph_choices: [species, bipartite]
    backend_choices: [pyg, numpy]
    temperature_range: [0.5, 1.0]
    ratio_scale_range: [0.85, 1.15]
    penalty_phase_range: [0.4, 1.4]
    penalty_charge_range: [0.4, 1.4]
    penalty_radical_range: [0.1, 0.9]
    penalty_role_range: [0.1, 0.9]

learnckpp:
  fallback_to_baseline_on_error: true
  candidate:
    max_candidates: 256
    min_flux_quantile: 0.70
  select:
    method: hard_concrete
    lambda_l0: 1.0e-3
    target_keep_ratio: 0.30
  rate:
    model: log_linear
    l2: 1.0e-6
  projection:
    enabled: true
    max_iter: 4
  fallback:
    select_method: l1_threshold
    threshold_quantile: 0.75
